import { useEffect, useState } from 'react';
import Link from 'next/link';
export default function Home() { const [msgs, setMsgs] = useState([]); const [q, setQ] = useState(''); const [loading, setLoading] = useState(false); async function fetchList(query) { setLoading(true); const url = '/api/messages?' + new URLSearchParams({ q: query || '', limit: '50' }); const r = await fetch(url); const j = await r.json(); setMsgs(j.results || []); setLoading(false); } useEffect(() => { fetchList(''); }, []); return ( <div style={{ maxWidth: 860, margin: '24px auto', padding: 12, fontFamily: 'system-ui, Arial' }}> <h1>Book of Truth — Messages</h1> <p>Use the search box to filter titles/excerpts (server-side search).</p> <div style={{ marginBottom: 12 }}> <input value={q} onChange={e => setQ(e.target.value)} placeholder="search..." style={{ padding:8, width:'70%' }} /> <button onClick={() => fetchList(q)} style={{ marginLeft:8, padding:8 }}>Search</button> </div> {loading && <div>Loading…</div>} <ul> {msgs.map(m => ( <li key={m.id} style={{ marginBottom: 10 }}> <Link href={`/messages/${m.slug}`}><a style={{ fontWeight: 600 }}>{m.title}</a></Link> <div style={{ fontSize: 13, color: '#555' }}>{m.date || 'No date'} — {m.excerpt}</div> </li> ))} </ul> <div style={{ marginTop: 24 }}> <a href="/book-of-truth-md.zip" download>Download Markdown + JSON (zip)</a> </div> </div> ) }
